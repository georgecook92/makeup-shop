"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_general=require("../db/interaction/general.js"),Queries=_interopRequireWildcard(_general),pool=require("../db/connect.js"),ProductsModel=function(){function t(e,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";_classCallCheck(this,t),this.sql=r,this.data=e,this.res=n,this.next=o}return _createClass(t,[{key:"getAllByCat",value:function(){var t=this;pool.getConnection().then(function(e){e.query(t.sql,[t.data.categoryId]).then(function(e){try{if(!(e.length>0))throw new Error("ID Not Found");t.res.json(e)}catch(e){console.log(e),t.next(e)}})}).catch(function(e){console.log(e),t.next(e)})}},{key:"getProduct",value:function(){var t=this;pool.getConnection().then(function(e){e.query(t.sql,[t.data.productId]).then(function(e){try{if(!(e.length>0))throw new Error("ID Not Found");t.res.json(e)}catch(e){console.log(e),t.next(e)}})}).catch(function(e){console.log(e),t.next(e)})}},{key:"changeProductQuantity",value:function(){Queries.standardUpdateQuery(this.sql,[this.data.quantity,this.data.productId],this.next,this.res)}},{key:"changeDiscount",value:function(){var t=this;pool.getConnection().then(function(e){e.query(t.sql,[t.data.quantity,t.data.productId]).then(function(n){try{if(!(n.affectedRows>0))throw new Error("ID Not Found");if(!(n.changedRows>0))throw new Error("Same Quantity");e.connection.release(),t.res.json({success:!0})}catch(e){console.log(e),t.next(e)}})}).catch(function(e){console.log(e),t.next(e)})}}]),t}();exports.default=ProductsModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVsL3Byb2R1Y3RzTW9kZWwuanMiXSwibmFtZXMiOlsiX2dlbmVyYWwiLCJyZXF1aXJlIiwiUXVlcmllcyIsInBvb2wiLCJQcm9kdWN0c01vZGVsIiwiZGF0YSIsInJlcyIsIm5leHQiLCJzcWwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX3RoaXMiLCJnZXRDb25uZWN0aW9uIiwidGhlbiIsImNvbm5lY3Rpb24iLCJxdWVyeSIsImNhdGVnb3J5SWQiLCJyZXN1bHQiLCJFcnJvciIsImpzb24iLCJlIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwiX3RoaXMyIiwicHJvZHVjdElkIiwic3RhbmRhcmRVcGRhdGVRdWVyeSIsInF1YW50aXR5IiwiX3RoaXMzIiwiYWZmZWN0ZWRSb3dzIiwiY2hhbmdlZFJvd3MiLCJyZWxlYXNlIiwic3VjY2VzcyJdLCJtYXBwaW5ncyI6Im1tQkFDQUEsU0FBQUMsUUFBQSxnQ0FBWUMsMENBRFJDLEtBQU9GLFFBQVEsb0JBR0VHLHlCQUNuQixRQUFBQSxHQUFZQyxFQUFNQyxFQUFLQyxHQUFnQixHQUFWQyxHQUFVQyxVQUFBQyxPQUFBLEdBQUFDLFNBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFKLEVBQUlHLGlCQUFBQyxLQUFBVCxHQUNyQ1MsS0FBS0wsSUFBTUEsRUFDWEssS0FBS1IsS0FBT0EsRUFDWlEsS0FBS1AsSUFBTUEsRUFOZk8sS0FBQU4sS0FBQUEsNkRBVWdCLEdBQUFPLEdBQUFELElBQ1pWLE1BQUtZLGdCQUFnQkMsS0FBSyxTQUFBQyxHQUN4QkEsRUFBV0MsTUFBTUosRUFBS04sS0FBTU0sRUFBS1QsS0FBS2MsYUFBYUgsS0FBSyxTQUFBSSxHQUN0RCxJQUNFLEtBQUlBLEVBQU9WLE9BQVMsR0FaVE4sS0FlSCxJQUFJaUIsT0FBTSxlQWxCakJwQixHQUFBQSxJQUFRcUIsS0FBQUYsR0FJWVosTUFBVWUsR0FpQi9CQyxRQUFRQyxJQUFJRixHQWpCbUJULEVBQUFQLEtBQUFnQixRQUdyQ0csTUFBS3BCLFNBQUFBLEdBQ0xrQixRQUFBQyxJQUFZbEIsR0FDYk8sRUFBQVAsS0FBQW9CLDBDQXVCWSxHQUFBQyxHQUFBZixJQXJCQ1YsTUFBQVksZ0JBQUFDLEtBQUEsU0FBQUMsR0F1QlZBLEVBQVdDLE1BQU1VLEVBQUtwQixLQUFNb0IsRUFBS3ZCLEtBQUt3QixZQUFZYixLQUFLLFNBQUFJLEdBdEJ6RGpCLElBQ0VjLEtBQUFBLEVBQVdDLE9BQU0sR0FHWCxLQUFBLElBQUtaLE9BQUwsZUFGSnNCLEdBQUl0QixJQUFBZ0IsS0FBQUYsR0FJQSxNQUFBRyxHQUNEQyxRQUFBQyxJQUFBRixHQUNGSyxFQUFDckIsS0FBQWdCLFFBSUhHLE1BWEQsU0FBQUMsR0FZREgsUUFiREMsSUFjT0UsR0FDTEgsRUFBQUEsS0FBUUMscURBOEJWdkIsUUFBUTRCLG9CQUFvQmpCLEtBQUtMLEtBQU1LLEtBQUtSLEtBQUswQixTQUFVbEIsS0FBS1IsS0FBS3dCLFdBQVloQixLQUFLTixLQUFNTSxLQUFLUCw4Q0F0QnpGLEdBQUEwQixHQUFBbkIsSUFDRlYsTUFBQVksZ0JBQVdMLEtBQVAsU0FBQU8sR0FDRkEsRUFBQUMsTUFBS1osRUFBSWdCLEtBQUtGLEVBQWRmLEtBQUEwQixTQUFBQyxFQUFBM0IsS0FBQXdCLFlBQUFiLEtBQUEsU0FBQUksR0FDRCxJQUNDLEtBQUFBLEVBQU1hLGFBQVUsR0FTdEJULEtBQVFDLElBQUlFLE9BQVosZUFSSyxNQUFBUCxFQUFBYyxZQUFBLEdBSUYsS0FBQSxJQUFBYixPQUFBLGdCQUhDSixHQUFVQSxXQUFBa0IsVUFDVlgsRUFBQUEsSUFBQUYsTUFBQWMsU0FBQSxJQVROLE1BQUFiLEdBa0JEQyxRQUFBQyxJQUFBRixHQUNEUyxFQUFBekIsS0FBQWdCLFFBNEJHRyxNQUFNLFNBQUFDLEdBQ0xILFFBQVFDLElBQUlFLEdBQ1pLLEVBQUt6QixLQUFLb0IsOEJBL0VLdkIiLCJmaWxlIjoibW9kZWwvcHJvZHVjdHNNb2RlbC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBwb29sID0gcmVxdWlyZSgnLi4vZGIvY29ubmVjdC5qcycpO1xuaW1wb3J0ICogYXMgUXVlcmllcyBmcm9tICcuLi9kYi9pbnRlcmFjdGlvbi9nZW5lcmFsLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdHNNb2RlbCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHJlcywgbmV4dCwgc3FsID0gJycpIHtcbiAgICB0aGlzLnNxbCA9IHNxbDtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIHRoaXMucmVzID0gcmVzO1xuICAgIHRoaXMubmV4dCA9IG5leHQ7XG4gIH1cblxuICBnZXRBbGxCeUNhdCgpIHtcbiAgICBwb29sLmdldENvbm5lY3Rpb24oKS50aGVuKGNvbm5lY3Rpb24gPT4ge1xuICAgICAgY29ubmVjdGlvbi5xdWVyeSh0aGlzLnNxbCwgW3RoaXMuZGF0YS5jYXRlZ29yeUlkXSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5yZXMuanNvbihyZXN1bHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lEIE5vdCBGb3VuZCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgIHRoaXMubmV4dChlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB0aGlzLm5leHQoZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFByb2R1Y3QoKSB7XG4gICAgcG9vbC5nZXRDb25uZWN0aW9uKCkudGhlbihjb25uZWN0aW9uID0+IHtcbiAgICAgIGNvbm5lY3Rpb24ucXVlcnkodGhpcy5zcWwsIFt0aGlzLmRhdGEucHJvZHVjdElkXSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5yZXMuanNvbihyZXN1bHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lEIE5vdCBGb3VuZCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgIHRoaXMubmV4dChlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB0aGlzLm5leHQoZXJyKTtcbiAgICB9KTtcbiAgfVxuICAvLyBBRE1JTiBQQU5FTCBTVFVGRlxuXG4gIC8vIERPIEkgTkVFRCBUTyBSRVRVUk4gQU5ZIERBVEEgQkVMT1cgT1IgV0lMTCBUSEFUIEhBUFBFTiBWSUEgRlJPTlQgRU5EPz8/Pz8/Pz8/XG5cbiAgY2hhbmdlUHJvZHVjdFF1YW50aXR5KCkge1xuICAgIFF1ZXJpZXMuc3RhbmRhcmRVcGRhdGVRdWVyeSh0aGlzLnNxbCwgW3RoaXMuZGF0YS5xdWFudGl0eSwgdGhpcy5kYXRhLnByb2R1Y3RJZF0sIHRoaXMubmV4dCwgdGhpcy5yZXMpO1xuICB9XG5cbiAgY2hhbmdlRGlzY291bnQoKSB7XG4gICAgcG9vbC5nZXRDb25uZWN0aW9uKCkudGhlbihjb25uZWN0aW9uID0+IHtcbiAgICAgIGNvbm5lY3Rpb24ucXVlcnkodGhpcy5zcWwsIFt0aGlzLmRhdGEucXVhbnRpdHksIHRoaXMuZGF0YS5wcm9kdWN0SWRdKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPiAwKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmNoYW5nZWRSb3dzID4gMCkge1xuICAgICAgICAgICAgICBjb25uZWN0aW9uLmNvbm5lY3Rpb24ucmVsZWFzZSgpO1xuICAgICAgICAgICAgICB0aGlzLnJlcy5qc29uKHtzdWNjZXNzOiB0cnVlfSk7XG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBubyBjaGFuZ2VkIHF1YW50aXR5XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2FtZSBRdWFudGl0eScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7IC8vIHdyb25nIGlkIVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJRCBOb3QgRm91bmQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICB0aGlzLm5leHQoZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgdGhpcy5uZXh0KGVycik7XG4gICAgfSk7XG4gIH1cblxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
