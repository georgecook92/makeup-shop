"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _authModel=require("../model/authModel.js"),_authModel2=_interopRequireDefault(_authModel),express=require("express"),router=express.Router(),mysql=require("mysql"),RateLimit=require("express-rate-limit"),createAccountLimiter=new RateLimit({windowMs:3e5,delayAfter:3,delayMs:3e3,max:5,message:"Too many attempts from this IP, please try again in five minutes",handler:function(e,t){t.json({error:"Too many attempts from this IP, please try again in five minutes"})}});router.post("/login",createAccountLimiter,function(e,t,r){var o="select * from `_users` where `email` = ?",i=new _authModel2.default(o,e.body,t);i.login()}),router.post("/register",createAccountLimiter,function(e,t,r){var o="select * from `_users` where `email` = ?",i=new _authModel2.default(o,e.body,t);i.register()}),router.post("/confirmUser",createAccountLimiter,function(e,t,r){var o="update _users set `verified` = 1, `token` = NULL where `token` = ?",i=new _authModel2.default(o,e.body,t);i.confirmUser()}),router.post("/changePassword",function(e,t,r){}),module.exports=router;