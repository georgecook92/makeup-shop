"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _authModel=require("../model/authModel.js"),_authModel2=_interopRequireDefault(_authModel),express=require("express"),router=express.Router(),mysql=require("mysql"),RateLimit=require("express-rate-limit"),createAccountLimiter=new RateLimit({windowMs:3e5,delayAfter:3,delayMs:3e3,max:5,message:"Too many attempts from this IP, please try again in five minutes",handler:function(e,t){t.json({error:"Too many attempts from this IP, please try again in five minutes"})}});router.post("/login",createAccountLimiter,function(e,t,r){var o="select * from `_users` where `email` = ?",i=new _authModel2.default(o,e.body,t,r);i.login()}),router.post("/register",createAccountLimiter,function(e,t,r){var o="select * from `_users` where `email` = ?",i=new _authModel2.default(o,e.body,t,r);i.register()}),router.post("/confirmUser",createAccountLimiter,function(e,t,r){var o="update _users set `verified` = 1, `token` = NULL where `token` = ?",i=new _authModel2.default(o,e.body,t,r);i.confirmUser()}),router.post("/changePassword",function(e,t,r){}),module.exports=router;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9hdXRoLmpzIl0sIm5hbWVzIjpbIl9hdXRoTW9kZWwiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsIm15c3FsIiwiY3JlYXRlQWNjb3VudExpbWl0ZXIiLCJSYXRlTGltaXQiLCJ3aW5kb3dNcyIsImRlbGF5QWZ0ZXIiLCJkZWxheU1zIiwicmVxIiwicmVzIiwibWF4IiwianNvbiIsImVycm9yIiwicG9zdCIsIm5leHQiLCJlbWFpbENoZWNrU1FMIiwiTW9kZWwiLCJfYXV0aE1vZGVsMiIsImRlZmF1bHQiLCJib2R5IiwibG9naW4iLCJyZWdpc3RlciIsInVwZGF0ZUNvbmZpcm1Vc2VyU1FMIiwiY29uZmlybVVzZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoicUZBS0EsR0FBQUEsWUFBQUMsUUFBQSx3RUFMSUMsUUFBVUQsUUFBUSxXQUNsQkUsT0FBU0QsUUFBUUUsU0FJckJDLE1BQUFKLFFBQUEsU0FKSUUsVUFBU0QsUUFBUUUsc0JBVWpCRSxxQkFBdUIsR0FBSUMsWUFGL0JDLFNBQUlELElBSUZFLFdBQVksRUFGZEMsUUFBSUosSUFDRkUsSUFBQUEsRUFDQUMsUUFBQUEsbUVBQ0FDLFFBQVMsU0FBQUMsRUFBRUMsR0FDWEMsRUFKdUNDLE1BSS9CQyxNQUFBLHVFQVdWWixRQUFBYSxLQUFBLFNBQUFWLHFCQUFBLFNBQUFLLEVBQUFDLEVBQUFLLEdBQ0EsR0FBQUMsR0FBQSwyQ0FJTUMsRUFBUSxHQUFBQyxhQUFBQyxRQUFjSCxFQUFlUCxFQUFJVyxLQUFNVixFQUFLSyxFQUYxRGQsR0FBT2EsVUFHTEcsT0FBQUEsS0FBTUksWUFBTmpCLHFCQUFBLFNBQUFLLEVBQUFDLEVBQUFLLEdBSEYsR0FBQUMsR0FBQSwyQ0FRTUMsRUFBUSxHQUFBQyxhQUFBQyxRQUFjSCxFQUFlUCxFQUFJVyxLQUFNVixFQUFLSyxFQUYxRGQsR0FBT2EsYUFHTEcsT0FBQUEsS0FBTUssZUFBTmxCLHFCQUFBLFNBQUFLLEVBQUFDLEVBQUFLLEdBSEYsR0FBQVEsR0FBQSxxRUFRTU4sRUFBUSxHQUFBQyxhQUFBQyxRQUFjSSxFQUFzQmQsRUFBSVcsS0FBTVYsRUFBS0ssRUFGakVkLEdBQU9hLGdCQUdMRyxPQUFBQSxLQUFNTyxrQkFBTixTQUFBZixFQUFBQyxFQUFBSyxNQVNGVSxPQUFPQyxRQUFVekIiLCJmaWxlIjoicm91dGVzL2F1dGguanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xudmFyIG15c3FsID0gcmVxdWlyZSgnbXlzcWwnKTtcblxuXG5pbXBvcnQgQXV0aE1vZGVsIGZyb20gJy4uL21vZGVsL2F1dGhNb2RlbC5qcyc7XG5cblxuXG52YXIgUmF0ZUxpbWl0ID0gcmVxdWlyZSgnZXhwcmVzcy1yYXRlLWxpbWl0Jyk7XG5cbnZhciBjcmVhdGVBY2NvdW50TGltaXRlciA9IG5ldyBSYXRlTGltaXQoe1xuICB3aW5kb3dNczogNSo2MCoxMDAwLCAvLyA1IG1pbnV0ZSB3aW5kb3dcbiAgZGVsYXlBZnRlcjogMywgLy8gYmVnaW4gc2xvd2luZyBkb3duIHJlc3BvbnNlcyBhZnRlciB0aGUgZmlyc3QgcmVxdWVzdFxuICBkZWxheU1zOiAzKjEwMDAsIC8vIHNsb3cgZG93biBzdWJzZXF1ZW50IHJlc3BvbnNlcyBieSAzIHNlY29uZHMgcGVyIHJlcXVlc3RcbiAgbWF4OiA1LCAvLyBzdGFydCBibG9ja2luZyBhZnRlciA1IHJlcXVlc3RzXG4gIG1lc3NhZ2U6IFwiVG9vIG1hbnkgYXR0ZW1wdHMgZnJvbSB0aGlzIElQLCBwbGVhc2UgdHJ5IGFnYWluIGluIGZpdmUgbWludXRlc1wiLFxuICBoYW5kbGVyOiAocmVxLHJlcykgPT4ge1xuICAgIHJlcy5qc29uKHsgJ2Vycm9yJzogJ1RvbyBtYW55IGF0dGVtcHRzIGZyb20gdGhpcyBJUCwgcGxlYXNlIHRyeSBhZ2FpbiBpbiBmaXZlIG1pbnV0ZXMnIH0pO1xuICB9XG59KTtcblxuLy9UT0RPOlxuXG4vL3NlbmQgZW1haWwgb3V0IG9uIHJlZ2lzdHJhdGlvbiAtIHNwYW0gY29udHJvbCAtIENIQU5HRSBTRU5EIEdSSUQgKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4vL2ZvcmdvdCBwYXNzd29yZFxuLy9jaGFuZ2UgcGFzc3dvcmQgKHRyeSBhbmQgbWFrZSB0aGlzIHdvcmsgZm9yIGJvdGggKGllIGFib3ZlIGFzIHdlbGwpKVxuXG5yb3V0ZXIucG9zdCgnL2xvZ2luJywgY3JlYXRlQWNjb3VudExpbWl0ZXIsIChyZXEscmVzLG5leHQpID0+IHtcbiAgdmFyIGVtYWlsQ2hlY2tTUUwgPSAnc2VsZWN0ICogZnJvbSBgX3VzZXJzYCB3aGVyZSBgZW1haWxgID0gPyc7XG4gIHZhciBNb2RlbCA9IG5ldyBBdXRoTW9kZWwoZW1haWxDaGVja1NRTCwgcmVxLmJvZHksIHJlcywgbmV4dCk7XG4gIE1vZGVsLmxvZ2luKCk7XG59KTtcblxucm91dGVyLnBvc3QoJy9yZWdpc3RlcicsIGNyZWF0ZUFjY291bnRMaW1pdGVyLCAocmVxLHJlcyxuZXh0KSA9PiB7XG4gIHZhciBlbWFpbENoZWNrU1FMID0gJ3NlbGVjdCAqIGZyb20gYF91c2Vyc2Agd2hlcmUgYGVtYWlsYCA9ID8nO1xuICB2YXIgTW9kZWwgPSBuZXcgQXV0aE1vZGVsKGVtYWlsQ2hlY2tTUUwsIHJlcS5ib2R5LCByZXMsIG5leHQpO1xuICBNb2RlbC5yZWdpc3RlcigpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvY29uZmlybVVzZXInLCBjcmVhdGVBY2NvdW50TGltaXRlciwgKHJlcSxyZXMsbmV4dCkgPT4ge1xuICBsZXQgdXBkYXRlQ29uZmlybVVzZXJTUUwgPSAndXBkYXRlIF91c2VycyBzZXQgYHZlcmlmaWVkYCA9IDEsIGB0b2tlbmAgPSBOVUxMIHdoZXJlIGB0b2tlbmAgPSA/JyA7XG4gIHZhciBNb2RlbCA9IG5ldyBBdXRoTW9kZWwodXBkYXRlQ29uZmlybVVzZXJTUUwsIHJlcS5ib2R5LCByZXMsIG5leHQpO1xuICBNb2RlbC5jb25maXJtVXNlcigpO1xufSk7XG5cbnJvdXRlci5wb3N0KCcvY2hhbmdlUGFzc3dvcmQnLCAocmVxLHJlcyxuZXh0KSA9PiB7XG5cbn0pO1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
