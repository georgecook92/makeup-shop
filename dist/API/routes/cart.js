"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,a){try{var c=r[o](a),u=c.value}catch(e){return void t(e)}return c.done?void e(u):Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var _cartModel=require("../model/cartModel.js"),_cartModel2=_interopRequireDefault(_cartModel),express=require("express"),router=express.Router();router.get("/getCart",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t,n){var o,a,c,u,s,i,d,l,_,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o="SELECT * FROM _cart where user_id = ?",a=r.get("Authorization")||"",c=new _cartModel2.default(r.body,n,a,o),e.next=6,c.checkCartExist();case 6:if(u=e.sent,console.log("cart exist",u),!u.success){e.next=17;break}return s="SELECT * FROM _cart inner join _cart_product on _cart_product.cart_id = _cart.cart_id where user_id = ?",i=new _cartModel2.default(r.body,n,a,s),e.next=13,i.getCart();case 13:d=e.sent,t.json(d),e.next=24;break;case 17:return l="insert into _cart SET user_id=?",_=new _cartModel2.default(r.body,n,a,l),e.next=21,_.createCart();case 21:f=e.sent,t.json({success:!1}),console.log("CREATED",f);case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.log(e.t0);case 29:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(r,t,n){return e.apply(this,arguments)}}()),module.exports=router;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9jYXJ0LmpzIl0sIm5hbWVzIjpbIl9jYXJ0TW9kZWwiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsImdldCIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvciIsInJlZ2VuZXJhdG9yUnVudGltZSIsIm1hcmsiLCJfY2FsbGVlIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsQ2hlY2tTUUwiLCJ0b2tlbiIsIk1vZGVsIiwiY2FydEV4aXN0IiwiZ2V0Q2FydFNRTCIsImNhcnRNb2RlbCIsInJlc3VsdCIsImNyZWF0ZUNhcnRTUUwiLCJDcmVhdGVDYXJ0TW9kZWwiLCJjcmVhdGVkQ2FydCIsIndyYXAiLCJfY29udGV4dCIsInByZXYiLCJfY2FydE1vZGVsMiIsImRlZmF1bHQiLCJib2R5IiwiY2hlY2tDYXJ0RXhpc3QiLCJzZW50Iiwic3VjY2VzcyIsImdldENhcnQiLCJqc29uIiwiY3JlYXRlQ2FydCIsInQwIiwiY29uc29sZSIsImxvZyIsInN0b3AiLCJ1bmRlZmluZWQiLCJfeCIsIl94MiIsIl94MyIsImFwcGx5IiwidGhpcyIsImFyZ3VtZW50cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJrWUFFQSxHQUFBQSxZQUFBQyxRQUFBLHdFQUZJQyxRQUFVRCxRQUFRLFdBQ2xCRSxPQUFTRCxRQUFRRSxRQUdyQkQsUUFBT0UsSUFBSSxXQUFYLFdBQUEsR0FBQUMsR0FBQUMsa0JBQUFDLG1CQUFBQyxLQUF1QixRQUFBQyxHQUFPQyxFQUFLQyxFQUFLQyxHQUFqQixHQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxDQUFBLE9BQUFmLG9CQUFBZ0IsS0FBQSxTQUFBQyxHQUFBLE9BQUEsT0FBQUEsRUFBQUMsS0FBQUQsRUFBQVosTUFBQSxJQUFBLEdBQUEsTUFBQVksR0FBQUMsS0FBQSxFQUVmWixFQUFnQix3Q0FDaEJDLEVBQVFKLEVBQUlOLElBQUksa0JBQW9CLEdBQ3BDVyxFQUFRLEdBQUFXLGFBQUFDLFFBQWNqQixFQUFJa0IsS0FBTWhCLEVBQU1FLEVBQU9ELEdBSjlCVyxFQUFBWixLQUFBLEVBS0dHLEVBQU1jLGdCQUxULEtBQUEsR0FBQSxHQUtmYixFQUxlUSxFQUFBTSxLQUpuQjdCLFFBQUFBLElBQVVELGFBQVFnQixJQVlkQSxFQUFVZSxRQVJLLENBQUFQLEVBQUFaLEtBQUEsRUFBQSxPQUFBLE1BU1hLLEdBQWEsMEdBVHpCQyxFQUFBLEdBQUFRLGFBQUFDLFFBQUFqQixFQUFBa0IsS0FBQWhCLEVBQUFFLEVBQUFHLEdBQXVCTyxFQUFBWixLQUFBLEdBQXZCTSxFQUFBYyxTQUF1QixLQUFBLElBQXZCYixFQUF1QkssRUFBQU0sS0FBQW5CLEVBQUFzQixLQUFBZCxHQUFBSyxFQUFBWixLQUFBLEVBQUEsTUFBQSxLQUFBLElBQUEsTUFBQVEsR0FBQSxrQ0FBQUMsRUFBQSxHQUFBSyxhQUFBQyxRQUFBakIsRUFBQWtCLEtBQUFoQixFQUFBRSxFQUFBTSxHQUFBSSxFQUFBWixLQUFBLEdBQUFTLEVBQUFhLFlBQUEsS0FBQSxJQUFBWixFQUFBRSxFQUFBTSxLQUFBbkIsRUFBQXNCLE1BQUFGLFNBQUEsSUFFZmxCLFFBQUFBLElBQUFBLFVBQWdCUyxFQUZELEtBQUEsSUFBQUUsRUFBQVosS0FBQSxFQUFBLE1BQUEsS0FBQSxJQUFBWSxFQUFBQyxLQUFBLEdBQUFELEVBQUFXLEdBQUFYLEVBQUEsTUFBQSxHQUFBWSxRQUFBQyxJQUFBYixFQUFBVyxHQUFBLEtBQUEsSUFBQSxJQUFBLE1BQUEsTUFBQVgsR0FBQWMsU0FBQTdCLEVBQUE4QixTQUFBLEVBQUEsUUFBdkIsT0FBQSxVQUFBQyxFQUFBQyxFQUFBQyxHQUFBLE1BQUFyQyxHQUFBc0MsTUFBQUMsS0FBQUMsZ0JBMEJBQyxPQUFPQyxRQUFVN0MiLCJmaWxlIjoicm91dGVzL2NhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuaW1wb3J0IENhcnRNb2RlbCBmcm9tICcuLi9tb2RlbC9jYXJ0TW9kZWwuanMnO1xuXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FydCcsIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIHZhciBlbWFpbENoZWNrU1FMID0gJ1NFTEVDVCAqIEZST00gX2NhcnQgd2hlcmUgdXNlcl9pZCA9ID8nO1xuICAgIHZhciB0b2tlbiA9IHJlcS5nZXQoJ0F1dGhvcml6YXRpb24nKSB8fCBcIlwiO1xuICAgIHZhciBNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBlbWFpbENoZWNrU1FMKTtcbiAgICB2YXIgY2FydEV4aXN0ID0gYXdhaXQgTW9kZWwuY2hlY2tDYXJ0RXhpc3QoKTtcbiAgICBjb25zb2xlLmxvZyhcImNhcnQgZXhpc3RcIiwgY2FydEV4aXN0KTtcblxuICAgIGlmIChjYXJ0RXhpc3Quc3VjY2Vzcykge1xuICAgICAgY29uc3QgZ2V0Q2FydFNRTCA9ICdTRUxFQ1QgKiBGUk9NIF9jYXJ0IGlubmVyIGpvaW4gX2NhcnRfcHJvZHVjdCBvbiBfY2FydF9wcm9kdWN0LmNhcnRfaWQgPSBfY2FydC5jYXJ0X2lkIHdoZXJlIHVzZXJfaWQgPSA/JztcbiAgICAgIHZhciBjYXJ0TW9kZWwgPSBuZXcgQ2FydE1vZGVsKHJlcS5ib2R5LCBuZXh0LCB0b2tlbiwgZ2V0Q2FydFNRTCk7XG4gICAgICB2YXIgcmVzdWx0ID0gYXdhaXQgY2FydE1vZGVsLmdldENhcnQoKTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjcmVhdGVDYXJ0U1FMID0gJ2luc2VydCBpbnRvIF9jYXJ0IFNFVCB1c2VyX2lkPT8nO1xuICAgICAgdmFyIENyZWF0ZUNhcnRNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBjcmVhdGVDYXJ0U1FMKTtcbiAgICAgIGNvbnN0IGNyZWF0ZWRDYXJ0ID0gYXdhaXQgQ3JlYXRlQ2FydE1vZGVsLmNyZWF0ZUNhcnQoKTtcbiAgICAgIHJlcy5qc29uKHtcInN1Y2Nlc3NcIjogZmFsc2V9KTtcbiAgICAgIGNvbnNvbGUubG9nKFwiQ1JFQVRFRFwiLCBjcmVhdGVkQ2FydCk7XG4gICAgfVxuICB9IGNhdGNoKGUpIHtcbiAgICBjb25zb2xlLmxvZyhlKTtcbiAgfVxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
