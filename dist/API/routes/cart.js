"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function n(o,c){try{var a=e[o](c),u=a.value}catch(t){return void r(t)}return a.done?void t(u):Promise.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)})}return n("next")})}}var _cartModel=require("../model/cartModel.js"),_cartModel2=_interopRequireDefault(_cartModel),express=require("express"),router=express.Router();router.get("/getCart",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r,n){var o,c,a,u,d,i,_,s,p,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o="SELECT * FROM _cart where user_id = ?",c=e.get("Authorization")||"test",a=new _cartModel2.default(e.body,n,c,o),t.next=6,a.checkCartExist();case 6:if(u=t.sent,0===u.length){t.next=16;break}return d="SELECT _product.product_id, _product.product_name, _product.price, _cart_product.quantity, _product.discount  FROM _cart inner join _cart_product on _cart_product.cart_id = _cart.cart_id inner join _product on _product.product_id = _cart_product.product_id where user_id = ?",i=new _cartModel2.default(e.body,n,c,d),t.next=12,i.getCart();case 12:_=t.sent,r.json({data:_,cartId:u[0].cart_id}),t.next=22;break;case 16:return s="insert into _cart SET user_id=?",p=new _cartModel2.default(e.body,n,c,s),t.next=20,p.createCart();case 20:l=t.sent,r.json([]);case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(0),console.log(t.t0);case 27:case"end":return t.stop()}},t,void 0,[[0,24]])}));return function(e,r,n){return t.apply(this,arguments)}}()),router.post("/addToCart",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r,n){var o,c,a,u,d,i,_,s,p,l,f,h,x,v,w;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o="SELECT * FROM _cart_product where cart_id = ? AND product_id = ?",c=e.get("Authorization")||"",a=new _cartModel2.default(e.body,n,c,o),t.next=6,a.checkCartProduct();case 6:if(u=t.sent,console.log("check",u),d=void 0,!(u.length>0)){t.next=17;break}return i="UPDATE _cart_product SET quantity = "+parseInt(e.body.quantity)+" where cart_id = ? AND product_id = ?",_=new _cartModel2.default(e.body,n,c,i),t.next=14,_.updateCartProduct();case 14:d=t.sent,t.next=22;break;case 17:return s="INSERT INTO _cart_product SET ?",p=new _cartModel2.default(e.body,n,c,s),t.next=21,p.addToCart();case 21:d=t.sent;case 22:return l="SELECT * FROM _cart where user_id = ?",f=new _cartModel2.default(e.body,n,c,l),t.next=26,f.checkCartExist();case 26:return h=t.sent,x="SELECT _product.product_id, _product.product_name, _product.price, _cart_product.quantity, _product.discount  FROM _cart inner join _cart_product on _cart_product.cart_id = _cart.cart_id inner join _product on _product.product_id = _cart_product.product_id where user_id = ?",v=new _cartModel2.default(e.body,n,c,x),t.next=31,v.getCart();case 31:w=t.sent,r.json({data:w,cartId:h[0].cart_id}),t.next=38;break;case 35:t.prev=35,t.t0=t.catch(0),console.log(t.t0);case 38:case"end":return t.stop()}},t,void 0,[[0,35]])}));return function(e,r,n){return t.apply(this,arguments)}}()),router.delete("/deleteFromCart",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r,n){var o,c,a,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o="DELETE FROM _cart_product where cart_id = ? AND product_id = ?",c=e.get("Authorization")||"",a=new _cartModel2.default(e.body,n,c,o),t.next=6,a.deleteFromCart();case 6:u=t.sent,r.json(u),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}},t,void 0,[[0,10]])}));return function(e,r,n){return t.apply(this,arguments)}}()),module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9jYXJ0LmpzIl0sIm5hbWVzIjpbIl9jYXJ0TW9kZWwiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsImdldCIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvciIsInJlZ2VuZXJhdG9yUnVudGltZSIsIm1hcmsiLCJfY2FsbGVlIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsQ2hlY2tTUUwiLCJ0b2tlbiIsIk1vZGVsIiwiY2FydEV4aXN0IiwiZ2V0Q2FydFNRTCIsImNhcnRNb2RlbCIsInJlc3VsdCIsImNyZWF0ZUNhcnRTUUwiLCJDcmVhdGVDYXJ0TW9kZWwiLCJjcmVhdGVkQ2FydCIsIndyYXAiLCJfY29udGV4dCIsInByZXYiLCJfY2FydE1vZGVsMiIsImRlZmF1bHQiLCJib2R5IiwiY2hlY2tDYXJ0RXhpc3QiLCJzZW50IiwiZ2V0Q2FydCIsImpzb24iLCJkYXRhIiwiY2FydElkIiwiY2FydF9pZCIsImNyZWF0ZUNhcnQiLCJ0MCIsInN0b3AiLCJ1bmRlZmluZWQiLCJfeCIsIl94MiIsIl94MyIsImFwcGx5IiwidGhpcyIsImFyZ3VtZW50cyIsIl9jYWxsZWUyIiwiY2hlY2tTUUwiLCJDaGVja0NhcnRNb2RlbCIsImNoZWNrIiwiYWRkU1FMIiwiVXBkYXRlQ2FydE1vZGVsIiwiX2FkZFNRTCIsIkFkZENhcnRNb2RlbCIsImNhcnRDaGVja1NRTCIsIl9jb250ZXh0MiIsImNoZWNrQ2FydFByb2R1Y3QiLCJsZW5ndGgiLCJwYXJzZUludCIsInF1YW50aXR5IiwidXBkYXRlQ2FydFByb2R1Y3QiLCJhZGRUb0NhcnQiLCJjb25zb2xlIiwibG9nIiwiZGVsZXRlIiwiX3JlZjMiLCJfY2FsbGVlMyIsIlNRTCIsIl9jb250ZXh0MyIsImRlbGV0ZUZyb21DYXJ0IiwiX3g3IiwiX3g4IiwiX3g5IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6ImtZQUVBLEdBQUFBLFlBQUFDLFFBQUEsd0VBRklDLFFBQVVELFFBQVEs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QSxTQUFBNkMsR0FBQSxPQUFBLE9BQUFBLEVBQUEzQyxLQUFBMkMsRUFBQXhELE1BQUEsSUFBQSxHQUFBLE1BQUF3RCxHQUFBM0MsS0FBQSxFQStEYjBDLEVBQU0saUVBM0NaTCxFQUFBQSxFQUFRQyxJQUFSLGtCQUFBLEdBNkNNaEQsRUFBUSxHQUFBVyxhQUFBQyxRQUFjakIsRUFBSWtCLEtBQU1oQixFQUFNRSxFQUFPcUQsR0FqRWhDQyxFQUFBeEQsS0FBQSxFQUFBRyxFQUFBc0QsZ0JBQUEsS0FBQSxHQUFBbEQsRUFBQWlELEVBQUF0QyxLQUFBbkIsRUFBQXFCLEtBQUFiLEdBQUFpRCxFQUFBeEQsS0FBQSxFQUFBLE1BQUEsS0FBQSxJQUFBd0QsRUFBQTNDLEtBQUEsR0FBQTJDLEVBQUEvQixHQUFBK0IsRUFBQSxNQUFBLEdBQUFOLFFBQUFDLElBQUFLLEVBQUEvQixHQUFBLEtBQUEsSUFBQSxJQUFBLE1BQUEsTUFBQStCLEdBQUE5QixTQUFBNEIsRUFBQTNCLFNBQUEsRUFBQSxRQUFBLE9BQUEsVUFBQStCLEVBQUFDLEVBQUFDLEdBQUEsTUFBQVAsR0FBQXRCLE1BQUFDLEtBQUFDLGdCQXlFdkI0QixPQUFPQyxRQUFVeEUiLCJmaWxlIjoicm91dGVzL2NhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuaW1wb3J0IENhcnRNb2RlbCBmcm9tICcuLi9tb2RlbC9jYXJ0TW9kZWwuanMnO1xuXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FydCcsIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGVtYWlsQ2hlY2tTUUwgPSAnU0VMRUNUICogRlJPTSBfY2FydCB3aGVyZSB1c2VyX2lkID0gPyc7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuZ2V0KCdBdXRob3JpemF0aW9uJykgfHwgXCJ0ZXN0XCI7XG4gICAgY29uc3QgTW9kZWwgPSBuZXcgQ2FydE1vZGVsKHJlcS5ib2R5LCBuZXh0LCB0b2tlbiwgZW1haWxDaGVja1NRTCk7XG4gICAgY29uc3QgY2FydEV4aXN0ID0gYXdhaXQgTW9kZWwuY2hlY2tDYXJ0RXhpc3QoKTtcblxuICAgIGlmIChjYXJ0RXhpc3QubGVuZ3RoICE9PSAwKSB7XG4gICAgICBjb25zdCBnZXRDYXJ0U1FMID0gJ1NFTEVDVCBfcHJvZHVjdC5wcm9kdWN0X2lkLCBfcHJvZHVjdC5wcm9kdWN0X25hbWUsIF9wcm9kdWN0LnByaWNlLCBfY2FydF9wcm9kdWN0LnF1YW50aXR5LCBfcHJvZHVjdC5kaXNjb3VudCAgRlJPTSBfY2FydCBpbm5lciBqb2luIF9jYXJ0X3Byb2R1Y3Qgb24gX2NhcnRfcHJvZHVjdC5jYXJ0X2lkID0gX2NhcnQuY2FydF9pZCBpbm5lciBqb2luIF9wcm9kdWN0IG9uIF9wcm9kdWN0LnByb2R1Y3RfaWQgPSBfY2FydF9wcm9kdWN0LnByb2R1Y3RfaWQgd2hlcmUgdXNlcl9pZCA9ID8nO1xuICAgICAgdmFyIGNhcnRNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBnZXRDYXJ0U1FMKTtcbiAgICAgIHZhciByZXN1bHQgPSBhd2FpdCBjYXJ0TW9kZWwuZ2V0Q2FydCgpO1xuICAgICAgLy8gd2lsbCByZXR1cm4gYSBzdWNjZXNzIHZhbHVlIGFuZCBkYXRhIGlmIHN1Y2Nlc3MgPT0gdHJ1ZVxuICAgICAgcmVzLmpzb24oe2RhdGE6IHJlc3VsdCwgY2FydElkOiBjYXJ0RXhpc3RbMF0uY2FydF9pZH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgY3JlYXRlQ2FydFNRTCA9ICdpbnNlcnQgaW50byBfY2FydCBTRVQgdXNlcl9pZD0/JztcbiAgICAgIHZhciBDcmVhdGVDYXJ0TW9kZWwgPSBuZXcgQ2FydE1vZGVsKHJlcS5ib2R5LCBuZXh0LCB0b2tlbiwgY3JlYXRlQ2FydFNRTCk7XG4gICAgICBjb25zdCBjcmVhdGVkQ2FydCA9IGF3YWl0IENyZWF0ZUNhcnRNb2RlbC5jcmVhdGVDYXJ0KCk7XG4gICAgICByZXMuanNvbihbXSk7XG4gICAgfVxuICB9IGNhdGNoKGUpIHtcbiAgICBjb25zb2xlLmxvZyhlKTtcbiAgfVxuXG59KTtcblxucm91dGVyLnBvc3QoXCIvYWRkVG9DYXJ0XCIsIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIC8vIGNoZWNrIGlmIHByb2R1Y3QgaXMgYWxyZWFkeSBpbiBjYXJ0IC0gaWYgc28gdXBkYXRlIGl0IC0gZWxzZSBhZGQgaXRcblxuICAgIGNvbnN0IGNoZWNrU1FMID0gXCJTRUxFQ1QgKiBGUk9NIF9jYXJ0X3Byb2R1Y3Qgd2hlcmUgY2FydF9pZCA9ID8gQU5EIHByb2R1Y3RfaWQgPSA/XCI7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuZ2V0KCdBdXRob3JpemF0aW9uJykgfHwgXCJcIjtcbiAgICBjb25zdCBDaGVja0NhcnRNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBjaGVja1NRTCk7XG4gICAgY29uc3QgY2hlY2sgPSBhd2FpdCBDaGVja0NhcnRNb2RlbC5jaGVja0NhcnRQcm9kdWN0KCk7XG4gICAgY29uc29sZS5sb2coJ2NoZWNrJywgY2hlY2spO1xuICAgIGxldCByZXN1bHQ7XG5cbiAgICBpZiAoY2hlY2subGVuZ3RoID4gMCkge1xuICAgICAgLy8gdG90YWwgcXVhbnRpdHlcbiAgICAgIC8vY29uc3QgcXVhbnRpdHkgPSBjaGVja1swXS5xdWFudGl0eSArIHBhcnNlSW50KHJlcS5ib2R5LnF1YW50aXR5KTtcbiAgICAgIC8vIHVwZGF0ZSBjYXJ0XG4gICAgICBjb25zdCBhZGRTUUwgPSBcIlVQREFURSBfY2FydF9wcm9kdWN0IFNFVCBxdWFudGl0eSA9IFwiICsgcGFyc2VJbnQocmVxLmJvZHkucXVhbnRpdHkpICsgXCIgd2hlcmUgY2FydF9pZCA9ID8gQU5EIHByb2R1Y3RfaWQgPSA/XCI7XG4gICAgICB2YXIgVXBkYXRlQ2FydE1vZGVsID0gbmV3IENhcnRNb2RlbChyZXEuYm9keSwgbmV4dCwgdG9rZW4sIGFkZFNRTCk7XG4gICAgICByZXN1bHQgPSBhd2FpdCBVcGRhdGVDYXJ0TW9kZWwudXBkYXRlQ2FydFByb2R1Y3QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYWRkU1FMID0gXCJJTlNFUlQgSU5UTyBfY2FydF9wcm9kdWN0IFNFVCA/XCI7XG4gICAgICB2YXIgQWRkQ2FydE1vZGVsID0gbmV3IENhcnRNb2RlbChyZXEuYm9keSwgbmV4dCwgdG9rZW4sIGFkZFNRTCk7XG4gICAgICByZXN1bHQgPSBhd2FpdCBBZGRDYXJ0TW9kZWwuYWRkVG9DYXJ0KCk7XG4gICAgfVxuXG4gICAgY29uc3QgY2FydENoZWNrU1FMID0gJ1NFTEVDVCAqIEZST00gX2NhcnQgd2hlcmUgdXNlcl9pZCA9ID8nO1xuICAgIGNvbnN0IE1vZGVsID0gbmV3IENhcnRNb2RlbChyZXEuYm9keSwgbmV4dCwgdG9rZW4sIGNhcnRDaGVja1NRTCk7XG4gICAgY29uc3QgY2FydEV4aXN0ID0gYXdhaXQgTW9kZWwuY2hlY2tDYXJ0RXhpc3QoKTtcbiAgICBjb25zdCBnZXRDYXJ0U1FMID0gJ1NFTEVDVCBfcHJvZHVjdC5wcm9kdWN0X2lkLCBfcHJvZHVjdC5wcm9kdWN0X25hbWUsIF9wcm9kdWN0LnByaWNlLCBfY2FydF9wcm9kdWN0LnF1YW50aXR5LCBfcHJvZHVjdC5kaXNjb3VudCAgRlJPTSBfY2FydCBpbm5lciBqb2luIF9jYXJ0X3Byb2R1Y3Qgb24gX2NhcnRfcHJvZHVjdC5jYXJ0X2lkID0gX2NhcnQuY2FydF9pZCBpbm5lciBqb2luIF9wcm9kdWN0IG9uIF9wcm9kdWN0LnByb2R1Y3RfaWQgPSBfY2FydF9wcm9kdWN0LnByb2R1Y3RfaWQgd2hlcmUgdXNlcl9pZCA9ID8nO1xuICAgIHZhciBjYXJ0TW9kZWwgPSBuZXcgQ2FydE1vZGVsKHJlcS5ib2R5LCBuZXh0LCB0b2tlbiwgZ2V0Q2FydFNRTCk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGNhcnRNb2RlbC5nZXRDYXJ0KCk7XG4gICAgcmVzLmpzb24oe2RhdGE6IGRhdGEsIGNhcnRJZDogY2FydEV4aXN0WzBdLmNhcnRfaWR9KTtcbiAgfSBjYXRjaChlKSB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gIH1cbn0pO1xuXG5yb3V0ZXIuZGVsZXRlKFwiL2RlbGV0ZUZyb21DYXJ0XCIsIGFzeW5jIChyZXEscmVzLG5leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBTUUwgPSBcIkRFTEVURSBGUk9NIF9jYXJ0X3Byb2R1Y3Qgd2hlcmUgY2FydF9pZCA9ID8gQU5EIHByb2R1Y3RfaWQgPSA/XCI7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuZ2V0KCdBdXRob3JpemF0aW9uJykgfHwgXCJcIjtcbiAgICBjb25zdCBNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBTUUwpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IE1vZGVsLmRlbGV0ZUZyb21DYXJ0KCk7XG4gICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgfSBjYXRjaChlKSB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdfQ==
