"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,a){try{var c=r[o](a),u=c.value}catch(e){return void t(e)}return c.done?void e(u):Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var _cartModel=require("../model/cartModel.js"),_cartModel2=_interopRequireDefault(_cartModel),express=require("express"),router=express.Router();router.get("/getCart",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t,n){var o,a,c,u,s,i,d,l,_,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o="SELECT * FROM _cart where user_id = ?",a=r.get("Authorization")||"",c=new _cartModel2.default(r.body,n,a,o),e.next=6,c.checkCartExist();case 6:if(u=e.sent,console.log("cart exist",u),!u.success){e.next=17;break}return s="SELECT * FROM _cart inner join _cart_product on _cart_product.cart_id = _cart.cart_id where user_id = ?",i=new _cartModel2.default(r.body,n,a,s),e.next=13,i.getCart();case 13:d=e.sent,t.json(d),e.next=24;break;case 17:return l="insert into _cart SET user_id=?",_=new _cartModel2.default(r.body,n,a,l),e.next=21,_.createCart();case 21:f=e.sent,t.json({success:!1}),console.log("CREATED",f);case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.log(e.t0);case 29:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(r,t,n){return e.apply(this,arguments)}}()),router.post("addToCart",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t,n){var o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{o="INSERT INTO _cart_product SET ?",a=r.get("Authorization")||""}catch(e){console.log(e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r,t,n){return e.apply(this,arguments)}}()),module.exports=router;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9jYXJ0LmpzIl0sIm5hbWVzIjpbIl9jYXJ0TW9kZWwiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsImdldCIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvciIsInJlZ2VuZXJhdG9yUnVudGltZSIsIm1hcmsiLCJfY2FsbGVlIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsQ2hlY2tTUUwiLCJ0b2tlbiIsIk1vZGVsIiwiY2FydEV4aXN0IiwiZ2V0Q2FydFNRTCIsImNhcnRNb2RlbCIsInJlc3VsdCIsImNyZWF0ZUNhcnRTUUwiLCJDcmVhdGVDYXJ0TW9kZWwiLCJjcmVhdGVkQ2FydCIsIndyYXAiLCJfY29udGV4dCIsInByZXYiLCJfY2FydE1vZGVsMiIsImRlZmF1bHQiLCJib2R5IiwiY2hlY2tDYXJ0RXhpc3QiLCJzZW50Iiwic3VjY2VzcyIsImdldENhcnQiLCJqc29uIiwiY3JlYXRlQ2FydCIsInQwIiwiY29uc29sZSIsImxvZyIsInN0b3AiLCJ1bmRlZmluZWQiLCJfeCIsIl94MiIsIl94MyIsImFwcGx5IiwidGhpcyIsImFyZ3VtZW50cyIsIl9jYWxsZWUyIiwiYWRkU1FMIiwiX2NvbnRleHQyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6ImtZQUVBLEdBQUFBLFlBQUFDLFFBQUEsd0VBRklDLFFBQVVELFFBQVEsV0FDbEJFLE9BQVNELFFBQVFFLFFBR3JCRCxRQUFPRSxJQUFJLFdBQVgsV0FBQSxHQUFBQyxHQUFBQyxrQkFBQUMsbUJBQUFDLEtBQXVCLFFBQUFDLEdBQU9DLEVBQUtDLEVBQUtDLEdBQWpCLEdBQUFDLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLENBQUEsT0FBQWYsb0JBQUFnQixLQUFBLFNBQUFDLEdBQUEsT0FBQSxPQUFBQSxFQUFBQyxLQUFBRCxFQUFBWixNQUFBLElBQUEsR0FBQSxNQUFBWSxHQUFBQyxLQUFBLEVBRWJaLEVBQWdCLHdDQUNoQkMsRUFBUUosRUFBSU4sSUFBSSxrQkFBb0IsR0FDcENXLEVBQVEsR0FBQVcsYUFBQUMsUUFBY2pCLEVBQUlrQixLQUFNaEIsRUFBTUUsRUFBT0QsR0FKaENXLEVBQUFaLEtBQUEsRUFLS0csRUFBTWMsZ0JBTFgsS0FBQSxHQUFBLEdBS2JiLEVBTGFRLEVBQUFNLEtBSm5CN0IsUUFBQUEsSUFBVUQsYUFBUWdCLElBWWRBLEVBQVVlLFFBUkssQ0FBQVAsRUFBQVosS0FBQSxFQUFBLE9BQUEsTUFTWEssR0FBYSwwR0FUekJDLEVBQUEsR0FBQVEsYUFBQUMsUUFBQWpCLEVBQUFrQixLQUFBaEIsRUFBQUUsRUFBQUcsR0FBdUJPLEVBQUFaLEtBQUEsR0FBdkJNLEVBQUFjLFNBQXVCLEtBQUEsSUFBdkJiLEVBQXVCSyxFQUFBTSxLQUFBbkIsRUFBQXNCLEtBQUFkLEdBQUFLLEVBQUFaLEtBQUEsRUFBQSxNQUFBLEtBQUEsSUFBQSxNQUFBUSxHQUFBLGtDQUFBQyxFQUFBLEdBQUFLLGFBQUFDLFFBQUFqQixFQUFBa0IsS0FBQWhCLEVBQUFFLEVBQUFNLEdBQUFJLEVBQUFaLEtBQUEsR0FBQVMsRUFBQWEsWUFBQSxLQUFBLElBQUFaLEVBQUFFLEVBQUFNLEtBRWJqQixFQUFBQSxNQUFBQSxTQUZhLElBR2JDLFFBQUFBLElBSGEsVUFHR1EsRUFISCxLQUFBLElBQUFFLEVBQUFaLEtBQUEsRUFBQSxNQUFBLEtBQUEsSUFBQVksRUFBQUMsS0FBQSxHQUFBRCxFQUFBVyxHQUFBWCxFQUFBLE1BQUEsR0FBQVksUUFBQUMsSUFBQWIsRUFBQVcsR0FBQSxLQUFBLElBQUEsSUFBQSxNQUFBLE1BQUFYLEdBQUFjLFNBQUE3QixFQUFBOEIsU0FBQSxFQUFBLFFBQXZCLE9BQUEsVUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxNQUFBckMsR0FBQXNDLE1BQUFDLEtBQUFDLGdCQU1JVCxPQUFBQSxLQUFBQSxZQUFBQSxXQUFBQSxHQUFBQSxHQUFBQSxrQkFBQUEsbUJBQUFBLEtBQVksUUFBQVUsR0FBQXBDLEVBQVpDLEVBQTBCSyxHQUFkLEdBQUErQixHQUFBakMsQ0FBQSxPQUFBUCxvQkFBQWdCLEtBQUEsU0FBQXlCLEdBQUEsT0FBQSxPQUFBQSxFQUFBdkIsS0FBQXVCLEVBQUFwQyxNQUFBLElBQUEsR0FzQmQsSUE1QnFCbUMsRUFBQSxrQ0FpQ2JqQyxFQUFRSixFQUFJTixJQUFJLGtCQUFvQixHQXhCbENhLE1BQUFBLEdBQ0ZDLFFBQUFBLElBQUFBLEdBSk0sSUFBQSxHQUFBLElBQUEsTUFBQSxNQUFBOEIsR0FBQVYsU0FBQVEsRUFBQVAsVUFBWkgsT0FBQUEsVUFBQUEsRUFBQUEsRUFBQUEsR0FBQUEsTUFBQUEsR0FBQUEsTUFBQUEsS0FBQUEsZ0JBTm1CYSxPQUFBQyxRQUFBaEQiLCJmaWxlIjoicm91dGVzL2NhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuaW1wb3J0IENhcnRNb2RlbCBmcm9tICcuLi9tb2RlbC9jYXJ0TW9kZWwuanMnO1xuXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FydCcsIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGVtYWlsQ2hlY2tTUUwgPSAnU0VMRUNUICogRlJPTSBfY2FydCB3aGVyZSB1c2VyX2lkID0gPyc7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuZ2V0KCdBdXRob3JpemF0aW9uJykgfHwgXCJcIjtcbiAgICBjb25zdCBNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBlbWFpbENoZWNrU1FMKTtcbiAgICBjb25zdCBjYXJ0RXhpc3QgPSBhd2FpdCBNb2RlbC5jaGVja0NhcnRFeGlzdCgpO1xuICAgIGNvbnNvbGUubG9nKFwiY2FydCBleGlzdFwiLCBjYXJ0RXhpc3QpO1xuXG4gICAgaWYgKGNhcnRFeGlzdC5zdWNjZXNzKSB7XG4gICAgICBjb25zdCBnZXRDYXJ0U1FMID0gJ1NFTEVDVCAqIEZST00gX2NhcnQgaW5uZXIgam9pbiBfY2FydF9wcm9kdWN0IG9uIF9jYXJ0X3Byb2R1Y3QuY2FydF9pZCA9IF9jYXJ0LmNhcnRfaWQgd2hlcmUgdXNlcl9pZCA9ID8nO1xuICAgICAgdmFyIGNhcnRNb2RlbCA9IG5ldyBDYXJ0TW9kZWwocmVxLmJvZHksIG5leHQsIHRva2VuLCBnZXRDYXJ0U1FMKTtcbiAgICAgIHZhciByZXN1bHQgPSBhd2FpdCBjYXJ0TW9kZWwuZ2V0Q2FydCgpO1xuICAgICAgLy8gd2lsbCByZXR1cm4gYSBzdWNjZXNzIHZhbHVlIGFuZCBkYXRhIGlmIHN1Y2Nlc3MgPT0gdHJ1ZVxuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGNyZWF0ZUNhcnRTUUwgPSAnaW5zZXJ0IGludG8gX2NhcnQgU0VUIHVzZXJfaWQ9Pyc7XG4gICAgICB2YXIgQ3JlYXRlQ2FydE1vZGVsID0gbmV3IENhcnRNb2RlbChyZXEuYm9keSwgbmV4dCwgdG9rZW4sIGNyZWF0ZUNhcnRTUUwpO1xuICAgICAgY29uc3QgY3JlYXRlZENhcnQgPSBhd2FpdCBDcmVhdGVDYXJ0TW9kZWwuY3JlYXRlQ2FydCgpO1xuICAgICAgcmVzLmpzb24oe1wic3VjY2Vzc1wiOiBmYWxzZX0pO1xuICAgICAgY29uc29sZS5sb2coXCJDUkVBVEVEXCIsIGNyZWF0ZWRDYXJ0KTtcbiAgICB9XG4gIH0gY2F0Y2goZSkge1xuICAgIGNvbnNvbGUubG9nKGUpO1xuICB9XG5cbn0pO1xuXG5yb3V0ZXIucG9zdChcImFkZFRvQ2FydFwiLCBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgdHJ5IHtcblxuICAgIC8vIGNoZWNrIGlmIHByb2R1Y3QgaXMgYWxyZWFkeSBpbiBjYXJ0IC0gaWYgc28gdXBkYXRlIGl0IC0gZWxzZSBhZGQgaXRcblxuICAgIGNvbnN0IGFkZFNRTCA9IFwiSU5TRVJUIElOVE8gX2NhcnRfcHJvZHVjdCBTRVQgP1wiO1xuICAgIGNvbnN0IHRva2VuID0gcmVxLmdldCgnQXV0aG9yaXphdGlvbicpIHx8IFwiXCI7XG4gIH0gY2F0Y2goZSkge1xuICAgIGNvbnNvbGUubG9nKGUpO1xuICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
