"use strict";var express=require("express"),router=express.Router(),config=require("../db/config.js"),secret=require("../jwtSecret.js"),jwt=require("jsonwebtoken");router.post("/createPayment",function(e,t){var r=e.get("Authorization")||"";try{var o,s;!function(){o=jwt.verify(r,secret),s=require("stripe")(config.stripeSecret);var n="gbp",c=e.body,u=c.amount,i=c.description;s.tokens.create({card:{number:"4242424242424242",exp_month:12,exp_year:2018,cvc:"123"}}).then(function(e){return console.log("created token",e),s.charges.create({amount:u,currency:n,description:i,source:e.id})}).then(function(e){console.log("response from stripe",e),t.json(e)}).catch(function(e){console.log("ERROR",e.statusCode);var r=e.statusCode?e.statusCode:400;t.status(r).json(e)})}()}catch(e){console.log(e),t.status(400).json(e)}}),module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9wYXltZW50LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwiY29uZmlnIiwiand0IiwicmVxIiwicmVzIiwicG9zdCIsImdldCIsImF1dGhUb2tlbiIsImRlY29kZWQiLCJzZWNyZXQiLCJzdHJpcGVTZWNyZXQiLCJzdHJpcGUiLCJfcmVxJGJvZHkiLCJib2R5IiwiYW1vdW50IiwiZGVzY3JpcHRpb24iLCJ2ZXJpZnkiLCJudW1iZXIiLCJjdXJyZW5jeSIsImV4cF95ZWFyIiwidGhlbiIsInRva2VuIiwiY29uc29sZSIsImxvZyIsInRva2VucyIsImNyZWF0ZSIsImNhcmQiLCJzb3VyY2UiLCJpZCIsInJlc3BvbnNlIiwiY2F0Y2giLCJlcnJvciIsInN0YXR1c0NvZGUiLCJlIiwianNvbiIsInN0YXR1cyJdLCJtYXBwaW5ncyI6IllBQUEsSUFBSUEsU0FBVUMsUUFBUSxXQUNsQkMsT0FBU0YsUUFBUUcsU0FEakJILE9BQUFBLFFBQVVDLG1CQUNWQyxPQUFTRixRQUFRRyxtQkFDakJDLElBQUFBLFFBQVNILGVBRWJDLFFBQUlHLEtBQU1KLGlCQUFRLFNBQUFLLEVBQWxCQyxHQUVBTCxHQUFPTSxHQUFLRixFQUFBRyxJQUFrQixrQkFBYyxFQUd4QyxLQUFJLEdBREVDLEdBRUFDLEdBREYsV0FERUQsRUFBWUosSUFBSUcsT0FBSUMsRUFBUkUsUUFFWkQsRUFERlYsUUFBQSxVQUFBRyxPQUFBUyxhQUFBLElBR0VDLEdBSEYsTUFBQUMsRUFLOEJULEVBQUlVLEtBQTVCQyxFQUxORixFQUtNRSxPQUFRQyxFQUxkSCxFQUtjRyxXQUpaUCxHQUFBQSxPQUFjUSxRQUVkTCxNQU1FTSxPQUFVLG1CQUxWQyxVQUFXLEdBSmZDLFNBSzhCaEIsS0FBeEJXLElBTE4sU0FjQ00sS0FBTSxTQUFDQyxHQVBWVixNQVFFVyxTQUFRQyxJQUFJLGdCQUFpQkYsR0FSeEJHLEVBQU9DLFFBQU9BLFFBQ2pCQyxPQUFBQSxFQUNFUixTQUFBQSxFQUNBSCxZQUFBQSxFQUNBWSxPQUFBTixFQUhJTyxPQUFBUixLQUFBLFNBQUFTLEdBRFZQLFFBT1NDLElBQUEsdUJBQVdNLEdBQ2xCUCxFQUFBQSxLQUFRQyxLQUNSTyxNQUFPbkIsU0FBQUEsR0FDSEcsUUFBQUEsSUFBQUEsUUFEeUJpQixFQUFBQyxXQUV6QmQsSUFBQUEsR0FBQUEsRUFBQUEsV0FGeUJhLEVBQUFDLFdBQUEsR0FHekJqQixHQUFBQSxPQUFBQSxHQUFBQSxLQUFBQSxRQUh5QixNQUE3QmtCLEdBTURYLFFBQVNDLElBQUFVLEdBQ1JYLEVBQUFBLE9BQVFDLEtBQUlXLEtBQUFELE1BS1o3QixPQUFBQSxRQUFJK0IiLCJmaWxlIjoicm91dGVzL3BheW1lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xudmFyIGNvbmZpZyA9IHJlcXVpcmUoJy4uL2RiL2NvbmZpZy5qcycpO1xudmFyIHNlY3JldCA9IHJlcXVpcmUoJy4uL2p3dFNlY3JldC5qcycpO1xudmFyIGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuXG5yb3V0ZXIucG9zdCgnL2NyZWF0ZVBheW1lbnQnLCAocmVxLCByZXMpID0+IHtcblxuICAgIGNvbnN0IGF1dGhUb2tlbiA9IHJlcS5nZXQoJ0F1dGhvcml6YXRpb24nKSB8fCBcIlwiO1xuICAgIHRyeSB7XG4gICAgICB2YXIgZGVjb2RlZCA9IGp3dC52ZXJpZnkoYXV0aFRva2VuLCBzZWNyZXQpO1xuXG4gICAgICB2YXIgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShjb25maWcuc3RyaXBlU2VjcmV0KTtcbiAgICAgIGNvbnN0IGN1cnJlbmN5ID0gXCJnYnBcIjtcbiAgICAgIGNvbnN0IHsgYW1vdW50LCBkZXNjcmlwdGlvbiB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIHN0cmlwZS50b2tlbnMuY3JlYXRlKHtcbiAgICAgICAgICBjYXJkOiB7XG4gICAgICAgICAgICBcIm51bWJlclwiOiAnNDI0MjQyNDI0MjQyNDI0MicsXG4gICAgICAgICAgICBcImV4cF9tb250aFwiOiAxMixcbiAgICAgICAgICAgIFwiZXhwX3llYXJcIjogMjAxOCxcbiAgICAgICAgICAgIFwiY3ZjXCI6ICcxMjMnXG4gICAgICAgICAgfVxuICAgICAgfSkudGhlbiggKHRva2VuKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGVkIHRva2VuJywgdG9rZW4pO1xuICAgICAgICByZXR1cm4gc3RyaXBlLmNoYXJnZXMuY3JlYXRlKHtcbiAgICAgICAgICAgIGFtb3VudCxcbiAgICAgICAgICAgIGN1cnJlbmN5LFxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBzb3VyY2U6IHRva2VuLmlkXG4gICAgICAgIH0pXG4gICAgICB9ICkudGhlbiggKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXNwb25zZSBmcm9tIHN0cmlwZScsIHJlc3BvbnNlKTtcbiAgICAgICAgcmVzLmpzb24ocmVzcG9uc2UpO1xuICAgICAgfSApLmNhdGNoKCAoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SJywgZXJyb3Iuc3RhdHVzQ29kZSk7XG4gICAgICAgIGNvbnN0IGNvZGUgPSBlcnJvci5zdGF0dXNDb2RlID8gZXJyb3Iuc3RhdHVzQ29kZSA6IDQwMDtcbiAgICAgICAgcmVzLnN0YXR1cyhjb2RlKS5qc29uKGVycm9yKTtcbiAgICAgIH0gKVxuICAgIH0gY2F0Y2goZSkge1xuICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuanNvbihlKTtcbiAgICB9XG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdfQ==
